
{
  "entities": {
    "car": {
      "title": "Car",
      "description": "Represents a car available for rent.",
      "type": "object",
      "properties": {
        "marque": { "type": "string", "description": "Brand of the car." },
        "modele": { "type": "string", "description": "Model of the car." },
        "immat": { "type": "string", "description": "License plate." },
        "immatWW": { "type": "string", "description": "Temporary license plate (WW)." },
        "numChassis": { "type": "string", "description": "Chassis number (VIN)." },
        "prixParJour": { "type": "number", "description": "Price per day." },
        "etat": {
          "type": "string",
          "description": "Condition of the car.",
          "enum": ["new", "good", "fair", "poor"]
        },
        "disponibilite": {
          "type": "string",
          "description": "Availability status of the car.",
          "enum": ["disponible", "louee", "maintenance"]
        },
        "photoURL": { "type": "string", "format": "uri", "description": "URL of the car's photo." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Creation timestamp." },
        "dateMiseEnCirculation": { "type": "string", "format": "date-time", "description": "Date of first registration." },
        "kilometrage": { "type": "number", "description": "Current mileage of the car." },
        "couleur": { "type": "string", "description": "Color of the car." },
        "nbrPlaces": { "type": "number", "description": "Number of seats." },
        "puissance": { "type": "number", "description": "Fiscal power of the car." },
        "carburantType": { "type": "string", "enum": ["Diesel", "Essence", "Electrique", "Hybrid"], "description": "Type of fuel." },
        "transmission": { "type": "string", "enum": ["Manuelle", "Automatique"], "description": "Type of transmission." },
        "dateExpirationAssurance": { "type": "string", "format": "date-time", "description": "Insurance expiration date." },
        "dateProchaineVisiteTechnique": { "type": "string", "format": "date-time", "description": "Next technical inspection date." },
        "anneeVignette": { "type": "number", "description": "Tax sticker year." },
        "maintenanceHistory": {
          "type": "array",
          "description": "A list of maintenance interventions.",
          "items": {
            "type": "object",
            "properties": {
              "date": { "type": "string", "format": "date-time", "description": "Date of the maintenance." },
              "kilometrage": { "type": "number", "description": "Mileage at the time of maintenance." },
              "typeIntervention": { "type": "string", "description": "Type of intervention (e.g., Vidange, Freins)." },
              "description": { "type": "string", "description": "Detailed description of the work done." },
              "cout": { "type": "number", "description": "Cost of the maintenance." }
            },
            "required": ["date", "kilometrage", "typeIntervention"]
          }
        },
        "maintenanceSchedule": {
          "type": "object",
          "description": "Rappels pour le prochain entretien.",
          "properties": {
            "prochainVidangeKm": { "type": "number", "description": "Kilométrage pour la prochaine vidange." },
            "prochainFiltreGasoilKm": { "type": "number", "description": "Kilométrage pour le prochain changement du filtre à gazole." },
            "prochainesPlaquettesFreinKm": { "type": "number", "description": "Kilométrage pour le prochain changement des plaquettes de frein." },
            "prochaineCourroieDistributionKm": { "type": "number", "description": "Kilométrage pour le prochain changement de la courroie de distribution." }
          }
        },
        "currentMaintenance": {
          "type": "object",
          "description": "Détails sur l'entretien en cours, le cas échéant.",
          "properties": {
            "startDate": {
              "type": "string",
              "format": "date-time",
              "description": "Date de début de la maintenance."
            },
            "reason": {
              "type": "string",
              "description": "Raison ou type d'intervention."
            },
            "notes": {
              "type": "string",
              "description": "Notes supplémentaires sur la maintenance."
            }
          }
        }
      },
      "required": ["marque", "modele", "immat", "numChassis", "prixParJour", "etat", "disponibilite", "dateMiseEnCirculation", "kilometrage", "couleur", "nbrPlaces", "puissance", "carburantType", "transmission"]
    },
    "client": {
      "title": "Client",
      "description": "Represents a client.",
      "type": "object",
      "properties": {
        "nom": { "type": "string" },
        "cin": { "type": "string" },
        "permisNo": { "type": "string" },
        "permisDateDelivrance": { "type": "string", "format": "date-time" },
        "telephone": { "type": "string" },
        "adresse": { "type": "string" },
        "photoCIN": { "type": "string", "format": "uri" },
        "otherPhotos": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "description": "A list of other photo URLs for the client."
        },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["nom", "cin", "telephone", "adresse"]
    },
    "rental": {
      "title": "Rental",
      "description": "Represents a rental contract.",
      "type": "object",
      "properties": {
        "contractNumber": { "type": "string", "description": "Structured contract number (e.g., C-YYYY-MM-SEQ)." },
        "locataire": {
          "type": "object",
          "properties": {
            "cin": { "type": "string" },
            "nomPrenom": { "type": "string" },
            "permisNo": { "type": "string" },
            "permisDateDelivrance": { "type": "string", "format": "date-time" },
            "telephone": { "type": "string" }
          }
        },
        "conducteur2": {
            "type": "object",
            "description": "Informations sur le deuxième conducteur (optionnel).",
            "properties": {
                "cin": { "type": "string", "description": "Numéro de CIN ou passeport." },
                "nomPrenom": { "type": "string", "description": "Nom et prénom." },
                "permisNo": { "type": "string", "description": "Numéro de permis de conduire." },
                "permisDateDelivrance": { "type": "string", "format": "date-time" },
                "telephone": { "type": "string", "description": "Numéro de téléphone." }
            }
        },
        "vehicule": {
          "type": "object",
          "properties": {
            "carId": { "type": "string" },
            "immatriculation": { "type": "string" },
            "marque": { "type": "string" },
            "dateMiseEnCirculation": { "type": "string", "format": "date-time", "description": "Date of first registration." },
            "couleur": { "type": "string" },
            "nbrPlaces": { "type": "number" },
            "puissance": { "type": "number" },
            "carburantType": { "type": "string" },
            "transmission": { "type": "string" },
            "photoURL": { "type": "string", "format": "uri" }
          }
        },
        "livraison": {
          "type": "object",
          "properties": {
            "dateHeure": { "type": "string", "format": "date-time" },
            "kilometrage": { "type": "number" },
            "carburantNiveau": { "type": "number" },
            "roueSecours": { "type": "boolean" },
            "posteRadio": { "type": "boolean" },
            "lavage": { "type": "boolean" },
            "dommages": {
              "type": "object",
              "description": "An object mapping damaged part IDs to the type of damage.",
              "additionalProperties": {
                "type": "string",
                "enum": ["rayure", "rayure_importante", "choc", "a_remplacer"]
              }
            },
            "dommagesNotes": { "type": "string" },
            "photos": { "type": "array", "items": { "type": "string", "format": "uri" }, "description": "URLs of photos taken at delivery." }
          }
        },
        "reception": {
          "type": "object",
          "properties": {
            "dateHeure": { "type": "string", "format": "date-time" },
            "kilometrage": { "type": "number" },
            "carburantNiveau": { "type": "number" },
            "roueSecours": { "type": "boolean" },
            "posteRadio": { "type": "boolean" },
            "lavage": { "type": "boolean" },
            "dommages": {
              "type": "object",
              "description": "An object mapping damaged part IDs to the type of damage.",
              "additionalProperties": {
                "type": "string",
                "enum": ["rayure", "rayure_importante", "choc", "a_remplacer"]
              }
            },
            "dommagesNotes": { "type": "string" },
            "photos": { "type": "array", "items": { "type": "string", "format": "uri" }, "description": "URLs of photos taken at reception." }
          }
        },
        "livraisonInspectionId": { "type": "string", "description": "ID of the delivery inspection document." },
        "receptionInspectionId": { "type": "string", "description": "ID of the reception inspection document." },
        "location": {
          "type": "object",
          "properties": {
            "dateDebut": { "type": "string", "format": "date-time" },
            "dateFin": { "type": "string", "format": "date-time" },
            "lieuDepart": { "type": "string", "description": "Lieu de départ de la location." },
            "lieuRetour": { "type": "string", "description": "Lieu de retour de la location." },
            "prixParJour": { "type": "number" },
            "nbrJours": { "type": "number" },
            "depot": { "type": "number" },
            "montantTotal": { "type": "number", "description": "Montant total de la location." },
            "montantPaye": { "type": "number", "description": "Montant déjà payé par le client." }
          }
        },
        "statut": { "type": "string", "enum": ["en_cours", "terminee"] },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["locataire", "vehicule", "location", "statut", "contractNumber"]
    },
    "inspection": {
      "title": "Inspection",
      "description": "Represents a vehicle inspection event (delivery or return).",
      "type": "object",
      "properties": {
        "vehicleId": { "type": "string", "description": "Reference to the vehicle." },
        "rentalId": { "type": "string", "description": "Reference to the rental contract." },
        "userId": { "type": "string", "description": "ID of the user who performed the inspection." },
        "timestamp": { "type": "string", "format": "date-time" },
        "type": { "type": "string", "enum": ["depart", "retour"] },
        "notes": { "type": "string" },
        "kilometrage": { "type": "number" },
        "carburantNiveau": { "type": "number" },
        "roueSecours": { "type": "boolean" },
        "posteRadio": { "type": "boolean" },
        "lavage": { "type": "boolean" },
        "photos": { "type": "array", "items": { "type": "string", "format": "uri" }}
      },
      "required": ["vehicleId", "rentalId", "userId", "timestamp", "type"]
    },
    "damage": {
      "title": "Damage",
      "description": "Represents a single point of damage on a vehicle.",
      "type": "object",
      "properties": {
        "partName": { "type": "string", "description": "The name of the damaged part (e.g., 'porte_avg')." },
        "damageType": { "type": "string", "enum": ["rayure", "rayure_importante", "choc", "a_remplacer"] },
        "photoURL": { "type": "string", "format": "uri", "description": "URL to a photo of the damage." },
        "positionX": { "type": "number", "description": "X coordinate on the diagram." },
        "positionY": { "type": "number", "description": "Y coordinate on the diagram." }
      },
      "required": ["partName", "damageType"]
    },
    "payment": {
      "title": "Payment",
      "description": "Represents a payment for a rental.",
      "type": "object",
      "properties": {
        "rentalId": { "type": "string", "description": "Reference to the rental contract." },
        "clientName": { "type": "string", "description": "Name of the client who paid."},
        "amount": { "type": "number", "description": "Amount paid."},
        "paymentDate": { "type": "string", "format": "date-time", "description": "Timestamp of the payment."},
        "paymentMethod": { "type": "string", "enum": ["Especes", "Carte bancaire", "Virement", "Avance"], "description": "Payment method."},
        "status": { "type": "string", "enum": ["complete", "en_attente"], "description": "Payment status."}
      },
      "required": ["rentalId", "clientName", "amount", "paymentDate", "paymentMethod", "status"]
    }
  },
  "auth": {
    "providers": ["anonymous"]
  },
  "firestore": {
    "/cars/{carId}": {
      "schema": { "$ref": "#/entities/car" },
      "description": "Stores car documents."
    },
    "/clients/{clientId}": {
      "schema": { "$ref": "#/entities/client" },
      "description": "Stores client documents."
    },
    "/rentals/{rentalId}": {
        "schema": { "$ref": "#/entities/rental" },
        "description": "Stores rental contract documents."
    },
    "/archived_rentals/{rentalId}": {
        "schema": { "$ref": "#/entities/rental" },
        "description": "Stores archived rental contract documents for long-term record-keeping."
    },
    "/inspections/{inspectionId}": {
        "schema": { "$ref": "#/entities/inspection" },
        "description": "Stores vehicle inspection events."
    },
    "/inspections/{inspectionId}/damages/{damageId}": {
        "schema": { "$ref": "#/entities/damage" },
        "description": "Stores specific damage points for an inspection."
    },
    "/payments/{paymentId}": {
      "schema": { "$ref": "#/entities/payment" },
      "description": "Stores payment records."
    },
    "/archived_payments/{paymentId}": {
      "schema": { "$ref": "#/entities/payment" },
      "description": "Stores archived payment records for long-term record-keeping."
    }
  }
}
